/*
 * ER/Studio 8.0 SQL Code Generation
 * Company :      FIUNAM
 * Project :      1Equipo-Appsafe.DM1
 * Authors :      Alvarez Lopez Carlos Manuel
				  Membrilla Isaias I�aki Ramos
				  Miram�n P�rez Jocelyn
 *
 * Date Created : Wednesday, April 16, 2025 17:39:49

 */

USE [APPSAFE]
GO

-- TRIGGER TR_AUTO_FOR1

BEGIN TRANSACTION TEST_TR_AUTO_FOR1_CANTIDAD

    INSERT INTO USUARIOS.AUTOMOVIL
    VALUES (100, 'OUT4TIME', 2025, 4, 1),
        (101, 'NRVOUS01', 2025, 4, 1),
        (102, 'A113PIXA', 2025, 4, 1);

ROLLBACK TRANSACTION

BEGIN TRANSACTION TEST_TR_AUTO_FOR1_AÑO

    INSERT INTO USUARIOS.AUTOMOVIL
    VALUES (100, 'OUT4TIME', 2000, 4, 1);

ROLLBACK TRANSACTION

-- TRIGGER TR_PAGO_FOR1

BEGIN TRANSACTION TEST_TR_PAGO_FOR1_PAGO_SEMANAL

    INSERT INTO OPERACIONES.PAGO
    VALUES (4, 123, 112, '2025-05-20'),
        (4, 124, 358, '2025-05-21');

ROLLBACK TRANSACTION

BEGIN TRANSACTION TEST_TR_PAGO_FOR1_PAGO_SEMANAL

    INSERT INTO OPERACIONES.PAGO
    VALUES (4, 123, 112, '2025-08-20');

    SELECT *
    FROM OPERACIONES.PAGO
    WHERE ID_USUARIO=4

ROLLBACK TRANSACTION

-- TRIGGER TR_TARJETA_FOR1
SELECT * FROM USUARIOS.TARJETA
BEGIN TRANSACTION TEST_TR_TARJETA_FOR1_CANTIDAD

    INSERT INTO USUARIOS.TARJETA
    VALUES (100, '2026-07-08', '0123456789023456', 1, 1),
        (101, '2026-07-08', '12345678901234567',1,1),
        (102, '2026-07-08', '123456789012345678',1,1);

ROLLBACK TRANSACTION

-- TRIGGER FechaInicioViaje
SELECT * FROM OPERACIONES.VIAJE
BEGIN TRANSACTION TEST_FechaInicioViaje

    INSERT INTO OPERACIONES.VIAJE
    VALUES (100, NULL, -99.1332, 19.4326, -99.1400, 19.4400, 0, NULL, NULL, NULL, NULL, NULL, 1, 1, 1, 1, NULL, NULL, NULL);
	
    UPDATE OPERACIONES.VIAJE
    SET ID_ESTATUS=3
    WHERE ID_VIAJE=100
	
	SELECT *
	FROM OPERACIONES.VIAJE
	WHERE ID_VIAJE=100

ROLLBACK TRANSACTION

-- TRIGGER TR_VIAJE_HORA

BEGIN TRANSACTION TEST_TR_VIAJE_HORA_PROGRAMADA

    INSERT INTO OPERACIONES.VIAJE
    VALUES (100, '2025-04-20 11:11:11', -99.1332, 19.4326, -99.1400, 19.4400, 0, NULL, NULL, NULL, NULL, NULL, 1, 5, 1, 1, NULL, NULL, NULL);

ROLLBACK TRANSACTION

--TRIGGER TR_VIAJE_CAMBIO_ESTATUS

BEGIN TRANSACTION TEST_TR_VIAJE_CAMBIO_ESTATUS

    INSERT INTO OPERACIONES.VIAJE
    VALUES (100, NULL, -99.1332, 19.4326, -99.1400, 19.4400, 0, NULL, NULL, NULL, NULL, NULL, 1, 1, 1, 1, NULL, NULL, NULL);

    UPDATE OPERACIONES.VIAJE
    SET ID_ESTATUS=5
    WHERE ID_VIAJE=100

ROLLBACK TRANSACTION

-- TRIGGER TR_VIAJE_ESTATUS_INICIAL

BEGIN TRANSACTION TEST_TR_VIAJE_ESTATUS_INICIAL

    INSERT INTO OPERACIONES.VIAJE
    VALUES (100, NULL, -99.1332, 19.4326, -99.1400, 19.4400, 0, NULL, NULL, NULL, NULL, NULL, 1, 5, 1, 1, NULL, NULL, NULL);

ROLLBACK TRANSACTION

