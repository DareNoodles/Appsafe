/*
 * ER/Studio 8.0 SQL Code Generation
 * Company :      FIUNAM
 * Project :      1Equipo-Appsafe.DM1
 * Authors :      Alvarez Lopez Carlos Manuel
				  Membrilla Isaias I�aki Ramos
				  Miram�n P�rez Jocelyn
 *
 * Date Created : Wednesday, April 16, 2025 17:39:49

 */

USE [APPSAFE]
GO

-- TRIGGER TR_AUTO_FOR1

BEGIN TRANSACTION TEST_TR_AUTO_FOR1_CANTIDAD

    INSERT INTO USUARIOS.AUTOMOVIL
    VALUES (100, 'OUT4TIME', 2025, 1, 1),
        (101, 'NRVOUS01', 2025, 1, 1),
        (102, 'A113PIXA', 2025, 1, 1);

ROLLBACK TRANSACTION

BEGIN TRANSACTION TEST_TR_AUTO_FOR1_AÑO

    INSERT INTO USUARIOS.AUTOMOVIL
    VALUES (100, 'OUT4TIME', 2000, 1, 1);

ROLLBACK TRANSACTION

-- TRIGGER TR_PAGO_FOR1

BEGIN TRANSACTION TEST_TR_PAGO_FOR1_PAGO_SEMANAL

    INSERT INTO OPERACIONES.PAGO
    VALUES (1, 123, 112, '2025-05-20'),
        (1, 124, 358, '2025-05-21');

ROLLBACK TRANSACTION

BEGIN TRANSACTION TEST_TR_PAGO_FOR1_PAGO_SEMANAL

    INSERT INTO OPERACIONES.PAGO
    VALUES (1, 123, 112, '2025-08-20');

    SELECT *
    FROM OPERACIONES.PAGO
    WHERE ID_USUARIO=1

ROLLBACK TRANSACTION

-- TRIGGER TR_TARJETA_FOR1

BEGIN TRANSACTION TEST_TR_TARJETA_FOR1_CANTIDAD_TARJETAS

    INSERT INTO USUARIOS.TARJETA
    VALUES (100, '2026-07-08'),
        (101, '2026-07-08'),
        (102, '2026-07-08');

ROLLBACK TRANSACTION

-- TRIGGER FechaInicioViaje

BEGIN TRANSACTION TEST_FechaInicioViaje_HORA_INICIO_EN_CURSO

    INSERT INTO OPERACIONES.VIAJE
    VALUES (100, NULL, -99.1332, 19.4326, -99.1400, 19.4400, 0, NULL, NULL, NULL, NULL, NULL, NULL, 1, 2, 1, 1, NULL, NULL, NULL);

    UPDATE OPERACIONES.VIAJE
    SET ID_ESTATUS=3
    WHERE ID_VIAJE=100

ROLLBACK TRANSACTION

-- TRIGGER TR_VIAJE_HORA

BEGIN TRANSACTION TEST_TR_VIAJE_HORA_PROGRAMADA

    INSERT INTO OPERACIONES.VIAJE
    VALUES (100, '2025-04-20 11:11:11', -99.1332, 19.4326, -99.1400, 19.4400, 0, NULL, NULL, NULL, NULL, NULL, NULL, 1, 2, 1, 1, NULL, NULL, NULL);

ROLLBACK TRANSACTION

--TRIGGER TR_VIAJE_CAMBIO_ESTATUS

BEGIN TRANSACTION TEST_TR_VIAJE_CAMBIO_ESTATUS

    INSERT INTO OPERACIONES.VIAJE
    VALUES (100, NULL, -99.1332, 19.4326, -99.1400, 19.4400, 0, NULL, NULL, NULL, NULL, NULL, NULL, 1, 1, 1, 1, NULL, NULL, NULL);

    UPDATE OPERACIONES.VIAJE
    SET ID_ESTATUS=5
    WHERE ID_VIAJE=100

ROLLBACK TRANSACTION

-- TRIGGER TR_VIAJE_ESTATUS_INICIAL

BEGIN TRANSACTION TEST_TR_VIAJE_ESTATUS_INICIAL

    INSERT INTO OPERACIONES.VIAJE
    VALUES (100, NULL, -99.1332, 19.4326, -99.1400, 19.4400, 0, NULL, NULL, NULL, NULL, NULL, NULL, 1, 5, 1, 1, NULL, NULL, NULL);

ROLLBACK TRANSACTION

