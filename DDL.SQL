/*
 * ER/Studio 8.0 SQL Code Generation
 * Company :      FIUNAM
 * Project :      1Equipo-Appsafe.DM1
 * Author :       CarlosMAL
 *
 * Date Created : Wednesday, April 16, 2025 17:39:49
 * Target DBMS : Microsoft SQL Server 2008
 */

/* 
 * TABLE: ACCIDENTE 
 */

CREATE TABLE ACCIDENTE(
    ID_ACCIDENTE         int       NOT NULL,
    FECHA                date      NOT NULL,
    LONGITUD             float     NOT NULL,
    LATITUD              float     NOT NULL,
    HERIDOS              bit       NOT NULL,
    MONTO                money     NOT NULL,
    ES_RESPONSABLE       bit       NOT NULL,
    ID_TIPO_ACCIDENTE    int       NOT NULL,
    ID_VIAJE             bigint    NOT NULL,
    CONSTRAINT PK_ACCIDENTE PRIMARY KEY NONCLUSTERED (ID_ACCIDENTE)
)
go



IF OBJECT_ID('ACCIDENTE') IS NOT NULL
    PRINT '<<< CREATED TABLE ACCIDENTE >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE ACCIDENTE >>>'
go

/* 
 * TABLE: ADMINISTRADOR 
 */

CREATE TABLE ADMINISTRADOR(
    ID_USUARIO       int     NOT NULL,
    FECHA_INGRESO    date    NOT NULL,
    CONSTRAINT PK_ADMINISTRADOR PRIMARY KEY NONCLUSTERED (ID_USUARIO)
)
go



IF OBJECT_ID('ADMINISTRADOR') IS NOT NULL
    PRINT '<<< CREATED TABLE ADMINISTRADOR >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE ADMINISTRADOR >>>'
go

/* 
 * TABLE: AUTO 
 */

CREATE TABLE AUTO(
    ID_AUTO       int         NOT NULL,
    NUMPLACAS     char(8)     NOT NULL,
    [AÑO(CK2)]    char(40)    NOT NULL,
    ID_USUARIO    int         NOT NULL,
    ID_MODELO     int         NOT NULL,
    CONSTRAINT PK_AUTO PRIMARY KEY NONCLUSTERED (ID_AUTO)
)
go



IF OBJECT_ID('AUTO') IS NOT NULL
    PRINT '<<< CREATED TABLE AUTO >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE AUTO >>>'
go

/* 
 * TABLE: BANCO 
 */

CREATE TABLE BANCO(
    ID_BANCO    tinyint     NOT NULL,
    NOMBRE      char(40)    NOT NULL,
    CONSTRAINT PK_BANCO PRIMARY KEY NONCLUSTERED (ID_BANCO)
)
go



IF OBJECT_ID('BANCO') IS NOT NULL
    PRINT '<<< CREATED TABLE BANCO >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE BANCO >>>'
go

/* 
 * TABLE: CATALOGO_ACCIDENTES 
 */

CREATE TABLE CATALOGO_ACCIDENTES(
    ID_TIPO_ACCIDENTE    int         NOT NULL,
    TIPO                 char(40)    NOT NULL,
    CONSTRAINT PK_CATALOGO_ACCIDENTES PRIMARY KEY NONCLUSTERED (ID_TIPO_ACCIDENTE)
)
go



IF OBJECT_ID('CATALOGO_ACCIDENTES') IS NOT NULL
    PRINT '<<< CREATED TABLE CATALOGO_ACCIDENTES >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE CATALOGO_ACCIDENTES >>>'
go

/* 
 * TABLE: CATALOGO_QUEJAS 
 */

CREATE TABLE CATALOGO_QUEJAS(
    ID_CATALOGO_QUEJAS    int         NOT NULL,
    MOTIVO                char(40)    NOT NULL,
    CONSTRAINT PK_CATALOGO_QUEJAS PRIMARY KEY NONCLUSTERED (ID_CATALOGO_QUEJAS)
)
go



IF OBJECT_ID('CATALOGO_QUEJAS') IS NOT NULL
    PRINT '<<< CREATED TABLE CATALOGO_QUEJAS >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE CATALOGO_QUEJAS >>>'
go

/* 
 * TABLE: CLIENTE 
 */

CREATE TABLE CLIENTE(
    ID_USUARIO               int               NOT NULL,
    RFC                      char(13)          NOT NULL,
    CELULAR                  numeric(13, 0)    NOT NULL,
    FECHA_REGISTRO           date              NOT NULL,
    DIRECCION_FACTURACIPN    char(40)          NOT NULL,
    CONSTRAINT PK_CLIENTE PRIMARY KEY NONCLUSTERED (ID_USUARIO)
)
go



IF OBJECT_ID('CLIENTE') IS NOT NULL
    PRINT '<<< CREATED TABLE CLIENTE >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE CLIENTE >>>'
go

/* 
 * TABLE: CONDUCTOR 
 */

CREATE TABLE CONDUCTOR(
    ID_USUARIO            int          NOT NULL,
    LICENCIA              char(8)      NOT NULL,
    FOTO                  image        NOT NULL,
    VIGENCIA              date         NOT NULL,
    [DESCRIPCION (CK11)]  char(600)    NOT NULL,
    CONSTRAINT PK_CONDUCTOR PRIMARY KEY NONCLUSTERED (ID_USUARIO)
)
go



IF OBJECT_ID('CONDUCTOR') IS NOT NULL
    PRINT '<<< CREATED TABLE CONDUCTOR >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE CONDUCTOR >>>'
go

/* 
 * TABLE: DESCUENTO 
 */

CREATE TABLE DESCUENTO(
    ID_DESCUENTO    int         NOT NULL,
    FECHA_INICIO    date        NOT NULL,
    FECHA_FIN       date        NOT NULL,
    MONTO           money       NOT NULL,
    ORIGEN          char(40)    NOT NULL,
    CONSTRAINT PK_DESCUENTO PRIMARY KEY NONCLUSTERED (ID_DESCUENTO)
)
go



IF OBJECT_ID('DESCUENTO') IS NOT NULL
    PRINT '<<< CREATED TABLE DESCUENTO >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE DESCUENTO >>>'
go

/* 
 * TABLE: DESCUENTO_USUARIO_VIAJE 
 */

CREATE TABLE DESCUENTO_USUARIO_VIAJE(
    ID_DESCUENTO    int    NOT NULL,
    ID_USUARIO      int    NOT NULL,
    CONSTRAINT PK_DESCUENTO_USUARIO_VIAJE PRIMARY KEY NONCLUSTERED (ID_DESCUENTO, ID_USUARIO)
)
go



IF OBJECT_ID('DESCUENTO_USUARIO_VIAJE') IS NOT NULL
    PRINT '<<< CREATED TABLE DESCUENTO_USUARIO_VIAJE >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE DESCUENTO_USUARIO_VIAJE >>>'
go

/* 
 * TABLE: ESTATUS 
 */

CREATE TABLE ESTATUS(
    ID_ESTATUS             tinyint     NOT NULL,
    [NOMBRE_ESTATUS(CK4)]  char(40)    NOT NULL,
    CONSTRAINT PK_ESTATUS PRIMARY KEY NONCLUSTERED (ID_ESTATUS)
)
go



IF OBJECT_ID('ESTATUS') IS NOT NULL
    PRINT '<<< CREATED TABLE ESTATUS >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE ESTATUS >>>'
go

/* 
 * TABLE: FACTURA 
 */

CREATE TABLE FACTURA(
    UUID            char(32)    NOT NULL,
    ID_USUARIO      int         NOT NULL,
    [IMPORTE(CK8)]  char(40)    NOT NULL,
    FECHA           char(40)    NOT NULL,
    CONSTRAINT PK_FACTURA PRIMARY KEY NONCLUSTERED (UUID)
)
go



IF OBJECT_ID('FACTURA') IS NOT NULL
    PRINT '<<< CREATED TABLE FACTURA >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE FACTURA >>>'
go

/* 
 * TABLE: MARCA 
 */

CREATE TABLE MARCA(
    ID_MARCA        int         NOT NULL,
    NOMBRE_MARCA    char(40)    NOT NULL,
    CONSTRAINT PK_MARCA PRIMARY KEY NONCLUSTERED (ID_MARCA)
)
go



IF OBJECT_ID('MARCA') IS NOT NULL
    PRINT '<<< CREATED TABLE MARCA >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE MARCA >>>'
go

/* 
 * TABLE: MODELO 
 */

CREATE TABLE MODELO(
    ID_MODELO        int         NOT NULL,
    NOMBRE_MODELO    char(40)    NOT NULL,
    ID_MARCA         int         NOT NULL,
    CONSTRAINT PK_MODELO PRIMARY KEY NONCLUSTERED (ID_MODELO)
)
go



IF OBJECT_ID('MODELO') IS NOT NULL
    PRINT '<<< CREATED TABLE MODELO >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE MODELO >>>'
go

/* 
 * TABLE: PAGO 
 */

CREATE TABLE PAGO(
    ID_USUARIO    int     NOT NULL,
    [FOLIO(CK7)]  int     NOT NULL,
    MONTO         int     NOT NULL,
    FECHA         date    NOT NULL,
    CONSTRAINT PK_PAGO PRIMARY KEY NONCLUSTERED (ID_USUARIO, [FOLIO(CK7)])
)
go



IF OBJECT_ID('PAGO') IS NOT NULL
    PRINT '<<< CREATED TABLE PAGO >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE PAGO >>>'
go

/* 
 * TABLE: QUEJA 
 */

CREATE TABLE QUEJA(
    ID_QUEJA                        int         NOT NULL,
    ID_VIAJE                        bigint      NOT NULL,
    TITULO                          char(40)    NOT NULL,
    FECHA_GENERACION                date        NOT NULL,
    [DESCRIPCION_QUEJA(CK13)]       char(40)    NOT NULL,
    [DESCRIPCION_RESOLUCION(CK14)]  char(40)    NULL,
    FECHA_RESOLUCION                date        NOT NULL,
    ID_CATALOGO_QUEJAS              int         NOT NULL,
    ID_USUARIO                      int         NOT NULL,
    CONSTRAINT PK_QUEJA PRIMARY KEY NONCLUSTERED (ID_QUEJA)
)
go



IF OBJECT_ID('QUEJA') IS NOT NULL
    PRINT '<<< CREATED TABLE QUEJA >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE QUEJA >>>'
go

/* 
 * TABLE: REGISTRO_UBICACION 
 */

CREATE TABLE REGISTRO_UBICACION(
    ID_REGISTRO_UBICACION    bigint      NOT NULL,
    LONGITUD                 float       NOT NULL,
    LATITUD                  int         NOT NULL,
    HORA                     datetime    NOT NULL,
    ID_VIAJE                 bigint      NOT NULL,
    CONSTRAINT PK_REGISTRO_UBICACION PRIMARY KEY NONCLUSTERED (ID_REGISTRO_UBICACION)
)
go



IF OBJECT_ID('REGISTRO_UBICACION') IS NOT NULL
    PRINT '<<< CREATED TABLE REGISTRO_UBICACION >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE REGISTRO_UBICACION >>>'
go

/* 
 * TABLE: TARJETA 
 */

CREATE TABLE TARJETA(
    ID_TARJETA    int               NOT NULL,
    VIGENCIA      date              NOT NULL,
    NUMERO        numeric(20, 0)    NOT NULL,
    ID_BANCO      tinyint           NOT NULL,
    ID_USUARIO    int               NOT NULL,
    CONSTRAINT PK_TARJETA PRIMARY KEY NONCLUSTERED (ID_TARJETA)
)
go



IF OBJECT_ID('TARJETA') IS NOT NULL
    PRINT '<<< CREATED TABLE TARJETA >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE TARJETA >>>'
go

/* 
 * TABLE: TELEFONO 
 */

CREATE TABLE TELEFONO(
    ID_USUARIO    int               NOT NULL,
    TELEFONO      numeric(13, 0)    NOT NULL,
    CONSTRAINT PK_TELEFONO PRIMARY KEY NONCLUSTERED (ID_USUARIO, TELEFONO)
)
go



IF OBJECT_ID('TELEFONO') IS NOT NULL
    PRINT '<<< CREATED TABLE TELEFONO >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE TELEFONO >>>'
go

/* 
 * TABLE: USUARIO 
 */

CREATE TABLE USUARIO(
    ID_USUARIO                 int         NOT NULL,
    ID_RECOMENDANTE            int         NULL,
    [TIPO_USUARIO(CK16)(CK3)]  char(40)    NOT NULL,
    [CONTRASE�A(CK10)]         char(40)    NOT NULL,
    NOMBRE_USUARIO             char(40)    NOT NULL,
    CORREO                     char(40)    NOT NULL,
    NOMBRE                     char(40)    NOT NULL,
    APELLIDO1                  char(40)    NOT NULL,
    APELLIDO2                  char(40)    NULL,
    CONSTRAINT PK_USUARIO PRIMARY KEY NONCLUSTERED (ID_USUARIO)
)
go



IF OBJECT_ID('USUARIO') IS NOT NULL
    PRINT '<<< CREATED TABLE USUARIO >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE USUARIO >>>'
go

/* 
 * TABLE: VIAJE 
 */

CREATE TABLE VIAJE(
    ID_VIAJE                       bigint       NOT NULL,
    [FECHA_INICIOVIAJE(CK18,CK6)]  date         NOT NULL,
    ORIGEN_LONGITUD                float        NOT NULL,
    ORIGEN_LATITUD                 float        NOT NULL,
    DESTINO_LONGITUD               float        NOT NULL,
    DESTINO_LATITUD                float        NOT NULL,
    IMPORTE                        money        NOT NULL,
    [PROPINA(CK15)]                money        NULL,
    [ADEUDO(CK17)]                 money        NULL,
    CALIFICACION                   int          NULL,
    [COMENTARIO(CK5)]              char(400)    NULL,
    [PAGO_CON_TARJETA(CK19)]       bit          NOT NULL,
    ID_ESTATUS                     tinyint      NOT NULL,
    ID_TARJETA                     int          NULL,
    ID_USUARIO                     int          NOT NULL,
    UUID                           char(32)     NULL,
    ID_AUTO                        int          NOT NULL,
    ID_DESCUENTO                   int          NULL,
    CONSTRAINT PK_VIAJE PRIMARY KEY NONCLUSTERED (ID_VIAJE)
)
go



IF OBJECT_ID('VIAJE') IS NOT NULL
    PRINT '<<< CREATED TABLE VIAJE >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE VIAJE >>>'
go

/* 
 * TABLE: VIAJE_ESTATUS 
 */

CREATE TABLE VIAJE_ESTATUS(
    ID_VIAJE      bigint      NOT NULL,
    ID_ESTATUS    tinyint     NOT NULL,
    FECHA_HORA    datetime    NOT NULL,
    CONSTRAINT PK_VIAJE PRIMARY KEY NONCLUSTERED (ID_VIAJE, ID_ESTATUS)
)
go



IF OBJECT_ID('VIAJE_ESTATUS') IS NOT NULL
    PRINT '<<< CREATED TABLE VIAJE_ESTATUS >>>'
ELSE
    PRINT '<<< FAILED CREATING TABLE VIAJE_ESTATUS >>>'
go

/* 
 * TABLE: ACCIDENTE 
 */

ALTER TABLE ACCIDENTE ADD CONSTRAINT FK_ACCIDENTE_CATALOGO_ACCIDENTES  
    FOREIGN KEY (ID_TIPO_ACCIDENTE)
    REFERENCES CATALOGO_ACCIDENTES(ID_TIPO_ACCIDENTE)
go

ALTER TABLE ACCIDENTE ADD CONSTRAINT FK_ACCIDENTE_VIAJE  
    FOREIGN KEY (ID_VIAJE)
    REFERENCES VIAJE(ID_VIAJE)
go


/* 
 * TABLE: ADMINISTRADOR 
 */

ALTER TABLE ADMINISTRADOR ADD CONSTRAINT FK_ADMINISTRADOR_USUARIO  
    FOREIGN KEY (ID_USUARIO)
    REFERENCES USUARIO(ID_USUARIO)
go


/* 
 * TABLE: AUTO 
 */

ALTER TABLE AUTO ADD CONSTRAINT FK_AUTO_CONDUCTOR
    FOREIGN KEY (ID_USUARIO)
    REFERENCES CONDUCTOR(ID_USUARIO)
go

ALTER TABLE AUTO ADD CONSTRAINT FK_AUTO_MODELO
    FOREIGN KEY (ID_MODELO)
    REFERENCES MODELO(ID_MODELO)
go


/* 
 * TABLE: CLIENTE 
 */

ALTER TABLE CLIENTE ADD CONSTRAINT FK_CLIENTE_USUARIO
    FOREIGN KEY (ID_USUARIO)
    REFERENCES USUARIO(ID_USUARIO)
go


/* 
 * TABLE: CONDUCTOR 
 */

ALTER TABLE CONDUCTOR ADD CONSTRAINT FK_CONDUCTOR_USUARIO
    FOREIGN KEY (ID_USUARIO)
    REFERENCES USUARIO(ID_USUARIO)
go


/* 
 * TABLE: DESCUENTO_USUARIO_VIAJE 
 */

ALTER TABLE DESCUENTO_USUARIO_VIAJE ADD CONSTRAINT FK_DESCUENTO_USUARIO_VIAJE_DESCUENTO
    FOREIGN KEY (ID_DESCUENTO)
    REFERENCES DESCUENTO(ID_DESCUENTO)
go

ALTER TABLE DESCUENTO_USUARIO_VIAJE ADD CONSTRAINT FK_DESCUENTO_USUARIO_VIAJE_USUARIO
    FOREIGN KEY (ID_USUARIO)
    REFERENCES USUARIO(ID_USUARIO)
go


/* 
 * TABLE: FACTURA 
 */

ALTER TABLE FACTURA ADD CONSTRAINT FK_FACTURA_CLIENTE
    FOREIGN KEY (ID_USUARIO)
    REFERENCES CLIENTE(ID_USUARIO)
go


/* 
 * TABLE: MODELO 
 */

ALTER TABLE MODELO ADD CONSTRAINT FK_MODELO_MARCA
    FOREIGN KEY (ID_MARCA)
    REFERENCES MARCA(ID_MARCA)
go


/* 
 * TABLE: PAGO 
 */

ALTER TABLE PAGO ADD CONSTRAINT FK_PAGO_CONDUCTOR
    FOREIGN KEY (ID_USUARIO)
    REFERENCES CONDUCTOR(ID_USUARIO)
go


/* 
 * TABLE: QUEJA 
 */

ALTER TABLE QUEJA ADD CONSTRAINT FK_QUEJA_VIAJE
    FOREIGN KEY (ID_VIAJE)
    REFERENCES VIAJE(ID_VIAJE)
go

ALTER TABLE QUEJA ADD CONSTRAINT FK_QUEJA_ADMINISTRADOR
    FOREIGN KEY (ID_USUARIO)
    REFERENCES ADMINISTRADOR(ID_USUARIO)
go

ALTER TABLE QUEJA ADD CONSTRAINT FK_QUEJA_CATALOGO_QUEJAS
    FOREIGN KEY (ID_CATALOGO_QUEJAS)
    REFERENCES CATALOGO_QUEJAS(ID_CATALOGO_QUEJAS)
go


/* 
 * TABLE: REGISTRO_UBICACION 
 */

ALTER TABLE REGISTRO_UBICACION ADD CONSTRAINT FK_REGISTRO_UBICACION_VIAJE  
    FOREIGN KEY (ID_VIAJE)
    REFERENCES VIAJE(ID_VIAJE)
go


/* 
 * TABLE: TARJETA 
 */

ALTER TABLE TARJETA ADD CONSTRAINT FK_TARJETA_BANCO
    FOREIGN KEY (ID_BANCO)
    REFERENCES BANCO(ID_BANCO)
go

ALTER TABLE TARJETA ADD CONSTRAINT FK_TARJETA_CLIENTE
    FOREIGN KEY (ID_USUARIO)
    REFERENCES CLIENTE(ID_USUARIO)
go


/* 
 * TABLE: TELEFONO 
 */

ALTER TABLE TELEFONO ADD CONSTRAINT FK_TELEFONO_ADMINISTRADOR
    FOREIGN KEY (ID_USUARIO)
    REFERENCES ADMINISTRADOR(ID_USUARIO)
go


/* 
 * TABLE: USUARIO 
 */

ALTER TABLE USUARIO ADD CONSTRAINT FK_USUARIO_USUARIO
    FOREIGN KEY (ID_RECOMENDANTE)
    REFERENCES USUARIO(ID_USUARIO)
go


/* 
 * TABLE: VIAJE 
 */

ALTER TABLE VIAJE ADD CONSTRAINT FK_VIAJE_DESCUENTO_USUARIO_VIAJE
    FOREIGN KEY (ID_DESCUENTO, ID_USUARIO)
    REFERENCES DESCUENTO_USUARIO_VIAJE(ID_DESCUENTO, ID_USUARIO)
go

ALTER TABLE VIAJE ADD CONSTRAINT FK_VIAJE_ESTATUS  
    FOREIGN KEY (ID_ESTATUS)
    REFERENCES ESTATUS(ID_ESTATUS)
go

ALTER TABLE VIAJE ADD CONSTRAINT FK_VIAJE_TARJETA
    FOREIGN KEY (ID_TARJETA)
    REFERENCES TARJETA(ID_TARJETA)
go

ALTER TABLE VIAJE ADD CONSTRAINT FK_VIAJE_CLIENTE
    FOREIGN KEY (ID_USUARIO)
    REFERENCES CLIENTE(ID_USUARIO)
go

ALTER TABLE VIAJE ADD CONSTRAINT FK_VIAJE_FACTURA
    FOREIGN KEY (UUID)
    REFERENCES FACTURA(UUID)
go

ALTER TABLE VIAJE ADD CONSTRAINT FK_VIAJE_AUTO
    FOREIGN KEY (ID_AUTO)
    REFERENCES AUTO(ID_AUTO)
go


/* 
 * TABLE: [VIAJE_ESTATUS] 
 */

ALTER TABLE VIAJE_ESTATUS ADD CONSTRAINT RefVIAJE43 
    FOREIGN KEY (ID_VIAJE)
    REFERENCES VIAJE(ID_VIAJE)
go

ALTER TABLE VIAJE_ESTATUS ADD CONSTRAINT RefESTATUS44 
    FOREIGN KEY (ID_ESTATUS)
    REFERENCES ESTATUS(ID_ESTATUS)
go


